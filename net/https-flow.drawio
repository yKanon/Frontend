<mxfile host="65bd71144e">
    <diagram id="TPgtoskTcQGao3l1IUSE" name="第 1 页">
        <mxGraphModel dx="910" dy="554" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1200" pageHeight="1920" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="36" value="" style="whiteSpace=wrap;html=1;verticalAlign=middle;dashed=1;fillStyle=auto;glass=0;shadow=0;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="20" y="360" width="790" height="570" as="geometry"/>
                </mxCell>
                <mxCell id="49" value="" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;gradientColor=none;verticalAlign=middle;" vertex="1" parent="1">
                    <mxGeometry x="60" y="670" width="730" height="250" as="geometry"/>
                </mxCell>
                <mxCell id="47" value="" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;gradientColor=none;verticalAlign=middle;" vertex="1" parent="1">
                    <mxGeometry x="60" y="370" width="730" height="280" as="geometry"/>
                </mxCell>
                <mxCell id="14" value="" style="whiteSpace=wrap;html=1;verticalAlign=middle;dashed=1;fillStyle=auto;glass=0;shadow=0;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="20" y="110" width="790" height="240" as="geometry"/>
                </mxCell>
                <mxCell id="3" value="服务端" style="whiteSpace=wrap;html=1;verticalAlign=top;fontSize=16;fillColor=#ffe6cc;strokeColor=#d79b00;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="510" y="80" width="250" height="880" as="geometry"/>
                </mxCell>
                <mxCell id="2" value="客户端" style="whiteSpace=wrap;html=1;verticalAlign=top;fontSize=16;fillColor=#d5e8d4;strokeColor=#82b366;sketch=1;" parent="1" vertex="1">
                    <mxGeometry x="80" y="80" width="240" height="880" as="geometry"/>
                </mxCell>
                <mxCell id="4" value="&lt;font&gt;&lt;font style=&quot;font-size: 12px&quot;&gt;发送https请求&lt;/font&gt;&lt;br&gt;&lt;/font&gt;" style="endArrow=classic;html=1;fontSize=16;sketch=1;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="320" y="122" as="sourcePoint"/>
                        <mxPoint x="510" y="122" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="370" y="122"/>
                            <mxPoint x="400" y="122"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="13" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;sketch=1;" edge="1" parent="1" source="6" target="9">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="6" value="&lt;font style=&quot;font-size: 12px&quot;&gt;与&lt;b&gt;公钥PUB&lt;/b&gt;配对的&lt;b&gt;私钥Private&lt;/b&gt;&lt;/font&gt;" style="ellipse;whiteSpace=wrap;html=1;fontSize=16;verticalAlign=middle;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="660" y="160" width="90" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="9" value="&lt;font style=&quot;font-size: 12px&quot;&gt;&lt;b&gt;CA证书&lt;/b&gt;&lt;br&gt;公钥PUB&lt;br&gt;颁发机构信息&lt;br&gt;公司信息&lt;br&gt;域名&lt;br&gt;其他。。。&lt;/font&gt;" style="whiteSpace=wrap;html=1;fontSize=16;verticalAlign=top;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="520" y="120" width="120" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="11" value="2⃣️" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontSize=12;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="630" y="270" width="40" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="12" value="1⃣️" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontSize=12;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="390" y="130" width="40" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="15" value="" style="shape=waypoint;size=6;pointerEvents=1;points=[];fillColor=#ffe6cc;resizable=0;rotatable=0;perimeter=centerPerimeter;snapToPoint=1;fontSize=16;verticalAlign=top;strokeColor=#d79b00;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="260" y="150" width="40" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="17" value="返回响应，包含数字证书" style="endArrow=classic;html=1;exitX=-0.005;exitY=0.101;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.997;entryY=0.096;entryDx=0;entryDy=0;entryPerimeter=0;sketch=1;" edge="1" parent="1" source="3" target="2">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="509" y="206" as="sourcePoint"/>
                        <mxPoint x="323" y="173" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="18" value="3⃣️" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;dashed=1;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="390" y="180" width="40" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="19" value="" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;gradientColor=none;verticalAlign=middle;dashed=1;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="110" y="120" width="180" height="470" as="geometry"/>
                </mxCell>
                <mxCell id="20" value="证书校验" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;shadow=0;glass=0;dashed=1;whiteSpace=wrap;horizontal=1;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="30" y="250" width="20" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;sketch=1;" edge="1" parent="1" source="23" target="24">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="23" value="客户端解析&lt;b&gt;证书&lt;/b&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_1;whiteSpace=wrap;shadow=0;fontFamily=Helvetica;fontSize=12;fontColor=#000000;align=center;strokeColor=#000000;fillColor=#ffffff;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="140" y="130" width="120" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="27" value="否" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;sketch=1;" edge="1" parent="1" source="24" target="26">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="30" value="是" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=12;sketch=1;" edge="1" parent="1" source="24" target="29">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="24" value="校验&lt;b&gt;证书&lt;/b&gt;的合法性" style="rhombus;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="140" y="230" width="120" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="26" value="显示https警告" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;shadow=0;glass=0;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="340" y="240" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="35" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=12;sketch=1;" edge="1" parent="1" source="29" target="34">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="29" value="提取&lt;b&gt;公钥PUB&lt;/b&gt;&lt;br&gt;生成&lt;b&gt;随机KEY&lt;/b&gt;" style="whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="140" y="390" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="34" value="使用&lt;b&gt;公钥PUB&lt;/b&gt;加密&lt;b&gt;KEY&lt;/b&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;shadow=0;fontFamily=Helvetica;fontSize=12;fontColor=#000000;align=center;strokeColor=#000000;fillColor=#ffffff;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="140" y="510" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="37" value="数据传输" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;dashed=1;fontSize=12;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="30" y="650" width="20" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="38" value="客户端将&lt;b&gt;KEY的密文&lt;br&gt;&lt;/b&gt;发送给服务端" style="endArrow=classic;html=1;fontSize=12;exitX=1.012;exitY=0.451;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.004;entryY=0.452;entryDx=0;entryDy=0;entryPerimeter=0;sketch=1;" edge="1" parent="1" source="2" target="3">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="400" y="520" as="sourcePoint"/>
                        <mxPoint x="450" y="470" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="39" value="5⃣️" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="395" y="490" width="40" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="40" value="" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;gradientColor=none;verticalAlign=middle;" vertex="1" parent="1">
                    <mxGeometry x="550" y="410" width="180" height="380" as="geometry"/>
                </mxCell>
                <mxCell id="43" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;orthogonalLoop=1;jettySize=auto;html=1;fontSize=12;" edge="1" parent="1" source="41" target="42">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="41" value="使用&lt;b&gt;私钥Private&lt;/b&gt;解密密文" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_1;whiteSpace=wrap;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;gradientColor=none;verticalAlign=middle;" vertex="1" parent="1">
                    <mxGeometry x="570" y="425" width="140" height="55" as="geometry"/>
                </mxCell>
                <mxCell id="45" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;sketch=1;orthogonalLoop=1;jettySize=auto;html=1;fontSize=12;" edge="1" parent="1" source="42" target="44">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="42" value="从解密结果中提取&lt;b&gt;随机KEY&lt;/b&gt;" style="whiteSpace=wrap;html=1;shadow=0;dashed=1;strokeWidth=2;glass=0;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="580" y="557.5" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="44" value="使用&lt;b&gt;随机KEY&lt;/b&gt;对称加密HTTP数据" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;shadow=0;dashed=1;fontFamily=Helvetica;fontSize=12;fontColor=#000000;align=center;strokeColor=#000000;fillColor=#ffffff;sketch=1;" vertex="1" parent="1">
                    <mxGeometry x="580" y="697.5" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="46" value="6⃣️" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="720" y="577.5" width="40" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="48" value="非对称加密" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="770" y="500" width="20" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="50" value="对称加密" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="770" y="785" width="20" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="51" value="返回经过随机KEY&lt;br&gt;加密后的HTTP数据报文" style="endArrow=classic;html=1;fontSize=12;exitX=-0.003;exitY=0.762;exitDx=0;exitDy=0;exitPerimeter=0;entryX=1.018;entryY=0.76;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="3" target="2">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="380" y="750" as="sourcePoint"/>
                        <mxPoint x="430" y="700" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="52" value="使用之前的随机KEY解密数据，获取明文信息" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;gradientColor=none;verticalAlign=middle;" vertex="1" parent="1">
                    <mxGeometry x="150" y="765" width="100" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="53" value="7⃣️" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="395" y="765" width="40" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="54" value="8⃣️" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="180" y="825" width="40" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="55" value="使用随机KEY对称加解密&lt;br&gt;后续请求和响应数据" style="endArrow=classic;startArrow=classic;html=1;fontSize=12;entryX=0.003;entryY=0.85;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1.008;exitY=0.849;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="2" target="3">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="380" y="760" as="sourcePoint"/>
                        <mxPoint x="430" y="710" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="56" value="9⃣️" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;dashed=1;sketch=1;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="395" y="840" width="40" height="20" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>